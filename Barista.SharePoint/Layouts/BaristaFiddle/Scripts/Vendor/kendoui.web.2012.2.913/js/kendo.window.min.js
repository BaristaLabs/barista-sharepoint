/*
* Kendo UI Web v2012.2.913 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Web commercial licenses may be obtained at
* https://www.kendoui.com/purchase/license-agreement/kendo-ui-web-commercial.aspx
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3.
* For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
*/
;(function(a,b){function S(a){var b=this;b.owner=a,b._draggable=new e(a.wrapper,{filter:o,group:a.wrapper.id+"-moving",dragstart:g(b.dragstart,b),drag:g(b.drag,b),dragend:g(b.dragend,b),dragcancel:g(b.dragcancel,b)})}function R(a){var b=this;b.owner=a,b._draggable=new e(a.wrapper,{filter:q,group:a.wrapper.id+"-resizing",dragstart:g(b.dragstart,b),drag:g(b.drag,b),dragend:g(b.dragend,b)})}function P(a,b){return function(){var a=this,c=a.wrapper,d=c[0].style,e=a.options;if(!e.isMaximized&&!e.isMinimized){a.restoreOptions={width:d.width,height:d.height},c.find(q).hide().end().find(J).parent().hide().eq(0).before(l.action({name:"Restore"})),b.call(a);return a}}}function O(b){return a(n).filter(function(){var c=a(this);return c.is(v)&&N(c,b).options.modal}).sort(function(b,c){return+a(b).css("zIndex")- +a(c).css("zIndex")})}function N(a,b){var c=a.children(p);return c.data("kendoWindow")||c.data("kendo"+b)}function M(a,b,c){return Math.max(Math.min(a,c),b)}function L(a){return typeof a!="undefined"}var c=window.kendo,d=c.ui.Widget,e=c.ui.Draggable,f=a.isPlainObject,g=a.proxy,h=a.extend,i=a.each,j=c.template,k="body",l,m=".kendoWindow",n=".k-window",o=".k-window-titlebar",p=".k-window-content",q=".k-resize-handle",r=".k-overlay",s="k-content-frame",t="k-loading",u="k-state-hover",v=":visible",w="hidden",x="cursor",y="open",z="activate",A="deactivate",B="close",C="refresh",D="resize",E="dragstart",F="dragend",G="error",H="overflow",I="zIndex",J=".k-window-actions .k-i-minimize,.k-window-actions .k-i-maximize",K=c.isLocalUrl,Q=d.extend({init:function(b,e){var h=this,j,k,p,q,r=!1,s;d.fn.init.call(h,b,e),e=h.options,b=h.element,s=e.content,h.appendTo=a(e.appendTo||document.body),h._animations(),s&&!f(s)&&(s=e.content={url:s}),b.parent().is(h.appendTo)||(b.is(v)?(k=b.offset(),r=!0):(p=b.css("visibility"),q=b.css("display"),b.css({visibility:w,display:""}),k=b.offset(),b.css({visibility:p,display:q}))),L(e.visible)||(e.visible=b.is(v)),j=h.wrapper=b.closest(n);if(!b.is(".k-content")||!j[0])b.addClass("k-window-content k-content"),h._createWindow(b,e),j=h.wrapper=b.closest(n),h._dimensions();k&&j.css({top:k.top,left:k.left}),s&&h.refresh(s),h.toFront(),e.visible&&e.modal&&h._overlay(j.is(v)).css({opacity:.5}),j.on("mouseenter"+m,".k-window-titlebar .k-window-action",function(){a(this).addClass(u)}).on("mouseleave"+m,".k-window-titlebar .k-window-action",function(){a(this).removeClass(u)}).on("click"+m,".k-window-titlebar .k-window-action",g(h._windowActionHandler,h)),e.resizable&&(j.on("dblclick"+m,o,g(h.toggleMaximization,h)),i("n e s w se sw ne nw".split(" "),function(a,b){j.append(l.resizeHandle(b))}),h.resizing=new R(h)),e.draggable&&(h.dragging=new S(h)),j.add(j.find(".k-resize-handle,.k-window-titlebar")).on("mousedown"+m,g(h.toFront,h)),h.touchScroller=c.touchScroller(b),h._resizeHandler=function(a){return h._onDocumentResize(a)},a(window).on("resize",h._resizeHandler),e.visible&&(h.trigger(y),h.trigger(z)),c.notify(h)},_dimensions:function(){var a=this,b=a.wrapper,c=a.element,d=a.options;a.title(d.title),d.width&&b.width(d.width),d.height&&b.height(d.height),i(["minWidth","minHeight","maxWidth","maxHeight"],function(a,b){var e=d[b];e&&e!=Infinity&&c.css(b,e)}),d.visible||b.hide()},_animations:function(){var a=this.options;a.animation===!1&&(a.animation={open:{show:!0,effects:{}},close:{hide:!0,effects:{}}})},setOptions:function(a){d.fn.setOptions.call(this,a),this._animations(),this._dimensions()},events:[y,z,A,B,C,D,E,F,G],options:{name:"Window",animation:{open:{effects:{zoom:{direction:"in"},fade:{direction:"in"}},duration:350,show:!0},close:{effects:{zoom:{direction:"out",properties:{scale:.7}},fade:{direction:"out"}},duration:350,hide:!0}},title:"",actions:["Close"],modal:!1,resizable:!0,draggable:!0,minWidth:90,minHeight:50,maxWidth:Infinity,maxHeight:Infinity},_overlay:function(b){var c=this.appendTo.children(".k-overlay"),d=this.wrapper;c.length||(c=a("<div class='k-overlay' />")),c.insertBefore(d[0]).toggle(b).css(I,parseInt(d.css(I),10)-1);return c},_windowActionHandler:function(b){var c=a(b.target).closest(".k-window-action").find(".k-icon"),d=this;i({"k-i-close":d.close,"k-i-maximize":d.maximize,"k-i-minimize":d.minimize,"k-i-restore":d.restore,"k-i-refresh":d.refresh},function(a,e){if(c.hasClass(a)){b.preventDefault(),e.call(d);return!1}})},center:function(){var b=this.wrapper,c=a(window);b.css({left:c.scrollLeft()+Math.max(0,(c.width()-b.width())/2),top:c.scrollTop()+Math.max(0,(c.height()-b.height())/2)});return this},title:function(a){var b=this,c=b.wrapper,d=b.options,e=c.find(o),f=e.children(".k-window-title"),g=e.outerHeight();if(!arguments.length)return f.text();a===!1?(c.addClass("k-window-titleless"),e.remove()):(e.length||c.prepend(l.titlebar(h(l,d))),c.css("padding-top",g),e.css("margin-top",-g)),f.text(a);return b},content:function(a){var b=this.wrapper.children(p);if(!a)return b.html();b.html(a);return this},open:function(){var b=this,c=b.wrapper,d=b.options,e=d.animation.open,f=c.children(p),g=f.css(H),h;b.trigger(y)||(b.toFront(),d.visible=!0,d.modal&&(h=b._overlay(!1),e.duration?h.kendoStop().kendoAnimate({effects:{fade:{direction:"in",properties:{opacity:.5}}},duration:e.duration,show:!0}):h.css("opacity",.5).show()),c.is(v)||(f.css(H,w),c.show().kendoStop().kendoAnimate({effects:e.effects,duration:e.duration,complete:function(){b.trigger(z),f.css(H,g)}}))),d.isMaximized&&(b._documentScrollTop=a(document).scrollTop(),a("html, body").css(H,w));return b},close:function(){var c=this,d=c.wrapper,e=c.options,f=e.animation.open,g=e.animation.close,h,i,j;d.is(v)&&!c.trigger(B)&&(e.visible=!1,h=O(e.name),i=e.modal&&h.length==1,j=e.modal?c._overlay(!0):a(b),i?g.duration?j.kendoStop().kendoAnimate({effects:"fade:out",duration:g.duration,hide:!0}):j.hide():h.length&&N(h.eq(h.length-2),e.name)._overlay(!0),d.kendoStop().kendoAnimate({effects:g.effects||f.effects,reverse:g.reverse===!0,duration:g.duration,complete:function(){d.hide(),c.trigger(A)}})),c.options.isMaximized&&(a("html, body").css(H,""),this._documentScrollTop&&this._documentScrollTop>0&&a(document).scrollTop(this._documentScrollTop));return c},toFront:function(){var b=this,c=b.wrapper,d=c[0],e=+c.css(I),f=e;a(n).each(function(b,c){var f=a(c),g=f.css(I),h=f.find(p);isNaN(g)||(e=Math.max(+g,e)),c!=d&&h.find("> ."+s).length>0&&h.append(l.overlay)});if(e==10001||f<e)c.css(I,e+2),b.element.find("> .k-overlay").remove();return b},toggleMaximization:function(){return this[this.options.isMaximized?"restore":"maximize"]()},restore:function(){var b=this,c=b.options,d=b.restoreOptions;if(!!c.isMaximized||!!c.isMinimized){b.wrapper.css({position:"absolute",left:d.left,top:d.top,width:d.width,height:d.height}).find(".k-window-content,.k-resize-handle").show().end().find(".k-window-titlebar .k-i-restore").parent().remove().end().end().find(J).parent().show(),a("html, body").css(H,""),this._documentScrollTop&&this._documentScrollTop>0&&a(document).scrollTop(this._documentScrollTop),c.isMaximized=c.isMinimized=!1,b.trigger(D);return b}},maximize:P("maximize",function(){var b=this,c=b.wrapper,d=c.position();h(b.restoreOptions,{left:d.left,top:d.top}),c.css({left:0,top:0,position:"fixed"}),this._documentScrollTop=a(document).scrollTop(),a("html, body").css(H,w),b.options.isMaximized=!0,b._onDocumentResize()}),minimize:P("minimize",function(){var a=this;a.wrapper.css("height",""),a.element.hide(),a.options.isMinimized=!0}),_onDocumentResize:function(){var b=this,c=b.wrapper,d=a(window);!b.options.isMaximized||(c.css({width:d.width(),height:d.height()-parseInt(c.css("padding-top"),10)}),b.trigger(D))},refresh:function(b){var c=this,d=c.options,e=a(c.element),g,i,k;f(b)||(b={url:b}),b=h({},d.content,b),i=L(d.iframe)?d.iframe:b.iframe,k=b.url,k?(L(i)||(i=!K(k)),i?(g=e.find("."+s)[0],g?g.src=k||g.src:e.html(l.contentFrame(h({},d,{content:b}))),e.find("."+s).unbind("load"+m).on("load"+m,function(){c.trigger(C)})):c._ajaxRequest(b)):(b.template&&c.content(j(b.template)({})),c.trigger(C));return c},_ajaxRequest:function(b){var c=this,d=b.template,e=c.wrapper.find(".k-window-titlebar .k-i-refresh"),f=setTimeout(function(){e.addClass(t)},100);a.ajax(h({type:"GET",dataType:"html",cache:!1,error:g(function(a,b){c.trigger(G,{status:b,xhr:a})},c),complete:function(){clearTimeout(f),e.removeClass(t)},success:g(function(a,b){d&&(a=j(d)(a||{})),c.element.html(a),c.trigger(C)},c)},b))},destroy:function(){var b=this,e,f;d.fn.destroy.call(b),b.wrapper.remove().add(b.wrapper.find(".k-resize-handle,.k-window-titlebar")).off(m),a(window).off("resize",b._resizeHandler),c.destroy(b.wrapper),e=O(),f=b.options.modal&&!e.length,f?b._overlay(!1).remove():e.length>0&&N(e.eq(e.length-2),b.options.name)._overlay(!0)},_createWindow:function(){var b=this,c=b.element,d=b.options,e,f;d.scrollable===!1&&c.attr("style","overflow:hidden;"),d.iframe&&d.content&&c.html(l.contentFrame(d)),f=a(l.wrapper(d)),d.title!==!1&&f.append(l.titlebar(h(l,d))),f.toggleClass("k-rtl",!!b.element.closest(".k-rtl").length),e=c.find("iframe:not(.k-content)").map(function(a){var b=this.getAttribute("src");this.src="";return b}),f.appendTo(b.appendTo).append(c).find("iframe:not(.k-content)").each(function(a){this.src=e[a]}),c.show()}});l={wrapper:j("<div class='k-widget k-window' />"),action:j("<a href='\\#' class='k-window-action k-link'><span class='k-icon k-i-#= name.toLowerCase() #'>#= name #</span></a>"),titlebar:j("<div class='k-window-titlebar k-header'>&nbsp;<span class='k-window-title'>#= title #</span><div class='k-window-actions k-header'># for (var i = 0; i < actions.length; i++) { ##= action({ name: actions[i] }) ## } #</div></div>"),overlay:"<div class='k-overlay' />",contentFrame:j("<iframe frameborder='0' title='#= title #' class='"+s+"' "+"src='#= content.url #'>"+"This page requires frames in order to show content"+"</iframe>"),resizeHandle:j("<div class='k-resize-handle k-resize-#= data #'></div>")},R.prototype={dragstart:function(b){var c=this,d=c.owner,e=d.wrapper;c.elementPadding=parseInt(d.wrapper.css("padding-top"),10),c.initialCursorPosition=e.offset(),c.resizeDirection=b.currentTarget.prop("className").replace("k-resize-handle k-resize-",""),c.initialSize={width:e.width(),height:e.height()},c.containerOffset=d.appendTo.offset(),e.append(l.overlay).find(q).not(b.currentTarget).hide(),a(k).css(x,b.currentTarget.css(x))},drag:function(a){var b=this,c=b.owner,d=c.wrapper,e=c.options,f=b.resizeDirection,g=b.containerOffset,h=b.initialCursorPosition,i=b.initialSize,j,k,l,m,n=a.x.location,o=a.y.location;f.indexOf("e")>=0?(j=n-h.left,d.width(M(j,e.minWidth,e.maxWidth))):f.indexOf("w")>=0&&(m=h.left+i.width,j=M(m-n,e.minWidth,e.maxWidth),d.css({left:m-j-g.left,width:j})),f.indexOf("s")>=0?(k=o-h.top-b.elementPadding,d.height(M(k,e.minHeight,e.maxHeight))):f.indexOf("n")>=0&&(l=h.top+i.height,k=M(l-o,e.minHeight,e.maxHeight),d.css({top:l-k-g.top,height:k})),c.trigger(D)},dragend:function(b){var c=this,d=c.owner,e=d.wrapper;e.find(r).remove().end().find(q).not(b.currentTarget).show(),a(k).css(x,""),d.touchScroller&&d.touchScroller.reset(),b.keyCode==27&&e.css(c.initialCursorPosition).css(c.initialSize);return!1}},S.prototype={dragstart:function(b){var c=this.owner,d=c.element,e=d.find(".k-window-actions"),f=c.appendTo.offset();c.trigger(E),c.initialWindowPosition=c.wrapper.position(),c.startPosition={left:b.x.client-c.initialWindowPosition.left,top:b.y.client-c.initialWindowPosition.top},e.length>0?c.minLeftPosition=e.outerWidth()+parseInt(e.css("right"),10)-d.outerWidth():c.minLeftPosition=20-d.outerWidth(),c.minLeftPosition-=f.left,c.minTopPosition=-f.top,c.wrapper.append(l.overlay).find(q).hide(),a(k).css(x,b.currentTarget.css(x))},drag:function(b){var c=this.owner,d={left:Math.max(b.x.client-c.startPosition.left,c.minLeftPosition),top:Math.max(b.y.client-c.startPosition.top,c.minTopPosition)};a(c.wrapper).css(d)},_finishDrag:function(){var b=this.owner;b.wrapper.find(q).toggle(!b.options.isMinimized).end().find(r).remove(),a(k).css(x,"")},dragcancel:function(a){this._finishDrag(),a.currentTarget.closest(n).css(this.owner.initialWindowPosition)},dragend:function(a){this._finishDrag(),this.owner.trigger(F);return!1}},c.ui.plugin(Q)})(jQuery);