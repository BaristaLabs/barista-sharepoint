/*
* Kendo UI Complete v2013.1.514 (http://kendoui.com)
* Copyright 2013 Telerik AD. All rights reserved.
*
* Kendo UI Complete commercial licenses may be obtained at
* https://www.kendoui.com/purchase/license-agreement/kendo-ui-complete-commercial.aspx
* If you do not own a commercial license, this file shall be governed by the trial license terms.
*/
("function"==typeof define&&define.amd?define:function(e,t){return t()})(["./kendo.data.min","./kendo.draganddrop.min"],function(){(function(e,t){function n(e){return function(t){var n=t.children(".k-animation-container");return n.length||(n=t),n.children(e)}}function i(e){return e.children("div").find(".k-checkbox:first :checkbox")}function r(e){return function(t,n){n=n.closest(M);var i,r=n.parent();return r.parent().is("li")&&(i=r.parent()),this._dataSourceMove(t,r,i,function(t,i){return this._insert(t.data(),i,n.index()+e)})}}function a(t){var n,i,r=t.children("div"),a=t.children("ul"),s=r.children(".k-icon"),o=t.children(":checkbox"),d=r.children(".k-in");if(!t.hasClass("k-treeview")&&(r.length||(r=e("<div />").prependTo(t)),!s.length&&a.length?s=e("<span class='k-icon' />").prependTo(r):a.length&&a.children().length||(s.remove(),a.remove()),o.length&&e("<span class='k-checkbox' />").appendTo(r).append(o),!d.length))for(d=e("<span class='k-in' />").appendTo(r)[0],n=r[0].nextSibling,d=r.find(".k-in")[0];n&&"ul"!=n.nodeName.toLowerCase();)i=n,n=n.nextSibling,3==i.nodeType&&(i.nodeValue=e.trim(i.nodeValue)),d.appendChild(i)}function s(e){var t=this;t.treeview=e,t.hovered=e.element,t._draggable=new p.Draggable(e.element,{filter:"div:not(.k-state-disabled) .k-in",hint:function(t){return e.templates.dragClue({item:e.dataItem(t),treeview:e.options})},cursorOffset:{left:10,top:u.support.touch||u.support.pointers?-40/u.support.zoomLevel():10},dragstart:_(t.dragstart,t),dragcancel:_(t.dragcancel,t),drag:_(t.drag,t),dragend:_(t.dragend,t)})}var o,d,l,c,u=window.kendo,p=u.ui,h=u.data,f=e.extend,g=u.template,m=e.isArray,k=p.Widget,v=h.HierarchicalDataSource,_=e.proxy,b=u.keys,x=".kendoTreeView",C="select",y="navigate",w="expand",T="change",N="error",S="checked",I="collapse",B="dragstart",A="drag",U="drop",D="dragend",H="dataBound",O="click",V="visibility",L="undefined",E="k-state-hover",q="k-treeview",F=":visible",M=".k-item",R="string",j="aria-selected",G="aria-disabled",P={text:"dataTextField",url:"dataUrlField",spriteCssClass:"dataSpriteCssClassField",imageUrl:"dataImageUrlField"},Q=function(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&1===e.nodeType&&typeof e.nodeName===R};d=n(".k-group"),l=n(".k-group,.k-content"),c=function(e){return e.children("div").children(".k-icon")},o=k.extend({init:function(e,t){var n,i=this,r=!1;m(t)&&(n=!0,t={dataSource:t}),t&&typeof t.loadOnDemand==L&&m(t.dataSource)&&(t.loadOnDemand=!1),k.prototype.init.call(i,e,t),e=i.element,t=i.options,r=e.is("ul")||e.hasClass(q),r&&(t.dataSource.list=e.is("ul")?e:e.children("ul")),i._animation(),i._accessors(),i._templates(),e.hasClass(q)?(i.wrapper=e,i.root=e.children("ul").eq(0)):(i._wrapper(),r&&(i.root=e,i._group(i.wrapper))),i._tabindex(),i.wrapper.filter("[role=tree]").length||i.wrapper.attr("role","tree"),i._dataSource(r),i._attachEvents(),t.dragAndDrop&&(i.dragging=new s(i)),r?i._attachUids():t.autoBind&&(i._progress(!0),i.dataSource.fetch()),t.checkboxes&&t.checkboxes.checkChildren&&i._updateIndeterminateInitial(i.wrapper),i.element[0].id&&(i._ariaId=u.format("{0}_tv_active",i.element[0].id))},_attachEvents:function(){var t=this,n=".k-in:not(.k-state-selected,.k-state-disabled)",i="mouseenter";t.wrapper.on(i+x,".k-in.k-state-selected",function(e){e.preventDefault()}).on(i+x,n,function(){e(this).addClass(E)}).on("mouseleave"+x,n,function(){e(this).removeClass(E)}).on(O+x,n,_(t._click,t)).on("dblclick"+x,".k-in:not(.k-state-disabled)",_(t._toggleButtonClick,t)).on(O+x,".k-plus,.k-minus",_(t._toggleButtonClick,t)).on("keydown"+x,_(t._keydown,t)).on("focus"+x,_(t._focus,t)).on("blur"+x,_(t._blur,t)).on("mousedown"+x,".k-in,.k-checkbox :checkbox,.k-plus,.k-minus",_(t._mousedown,t)).on("change"+x,".k-checkbox :checkbox",_(t._checkboxChange,t)).on("click"+x,".k-checkbox :checkbox",_(t._checkboxClick,t)).on("click"+x,".k-request-retry",_(t._retryRequest,t)).on("click"+x,function(n){e(n.target).is(":focusable")||t.focus()})},_checkboxClick:function(t){var n=e(t.target);n.data("indeterminate")&&(n.data("indeterminate",!1).prop("indeterminate",!1).prop(S,!0),this._checkboxChange(t))},_attachUids:function(t,n){var i,r=this,a=u.attr("uid");t=t||r.root,n=n||r.dataSource,i=n.view(),t.children("li").each(function(t,n){n=e(n).attr(a,i[t].uid),n.attr("role","treeitem"),r._attachUids(n.children("ul"),i[t].children)})},_animation:function(){var e=this.options,t=e.animation;t===!1?t={expand:{effects:{}},collapse:{hide:!0,effects:{}}}:t.collapse&&"effects"in t.collapse||(t.collapse=f({reverse:!0},t.expand)),f(t.collapse,{hide:!0}),e.animation=t},_templates:function(){var e=this,t=e.options,n=_(e._fieldAccessor,e);t.template&&typeof t.template==R?t.template=g(t.template):t.template||(t.template=g("# var text = "+n("text")+"(item); #"+"# if (typeof item.encoded != 'undefined' && item.encoded === false) {#"+"#= text #"+"# } else { #"+"#: text #"+"# } #")),e._checkboxes(),e.templates={wrapperCssClass:function(e,t){var n="k-item",i=t.index;return e.firstLevel&&0===i&&(n+=" k-first"),i==e.length-1&&(n+=" k-last"),n},cssClass:function(e,t){var n="",i=t.index,r=e.length-1;return e.firstLevel&&0===i&&(n+="k-top "),n+=0===i&&i!=r?"k-top":i==r?"k-bot":"k-mid"},textClass:function(e){var t="k-in";return e.enabled===!1&&(t+=" k-state-disabled"),e.selected===!0&&(t+=" k-state-selected"),t},toggleButtonClass:function(e){var t="k-icon";return t+=e.expanded!==!0?" k-plus":" k-minus",e.enabled===!1&&(t+="-disabled"),t},groupAttributes:function(e){return e.expanded!==!0?" style='display:none'":""},groupCssClass:function(e){var t="k-group";return e.firstLevel&&(t+=" k-treeview-lines"),t},dragClue:g("<div class='k-header k-drag-clue'><span class='k-icon k-drag-status' />#= treeview.template(data) #</div>"),group:g("<ul class='#= r.groupCssClass(group) #'#= r.groupAttributes(group) # role='group'>#= renderItems(data) #</ul>"),itemContent:g("# var imageUrl = "+n("imageUrl")+"(item); #"+"# var spriteCssClass = "+n("spriteCssClass")+"(item); #"+"# if (imageUrl) { #"+"<img class='k-image' alt='' src='#= imageUrl #'>"+"# } #"+"# if (spriteCssClass) { #"+"<span class='k-sprite #= spriteCssClass #' />"+"# } #"+"#= treeview.template(data) #"),itemElement:g("# var url = "+n("url")+"(item); #"+"<div class='#= r.cssClass(group, item) #'>"+"# if (item.hasChildren) { #"+"<span class='#= r.toggleButtonClass(item) #' role='presentation' />"+"# } #"+"# if (treeview.checkboxes) { #"+"<span class='k-checkbox' role='presentation'>"+"#= treeview.checkboxes.template(data) #"+"</span>"+"# } #"+"# var tag = url ? 'a' : 'span'; #"+"# var textAttr = url ? ' href=\\'' + url + '\\'' : ''; #"+"<#=tag#  class='#= r.textClass(item) #'#= textAttr #>"+"#= r.itemContent(data) #"+"</#=tag#>"+"</div>"),item:g("<li role='treeitem' class='#= r.wrapperCssClass(group, item) #' "+u.attr("uid")+"='#= item.uid #'"+"#=item.selected ? \"aria-selected='true'\" : ''#"+"#=item.enabled === false ? \"aria-disabled='true'\" : ''#"+">"+"#= r.itemElement(data) #"+"</li>"),loading:g("<div class='k-icon k-loading' /> Loading..."),retry:g("Request failed. <button class='k-button k-request-retry'>Retry</button>")}},items:function(){return this.element.find(".k-item")},setDataSource:function(e){this.options.dataSource=e,this._dataSource(),this.dataSource.fetch()},_dataSource:function(e){function t(e){for(var n=0;e.length>n;n++)e[n]._initChildren(),e[n].children.fetch(),t(e[n].children.view())}var n=this,i=n.options,r=i.dataSource;r=m(r)?{data:r}:r,n.dataSource&&(n.dataSource.unbind(T,_(n.refresh,n)),n.dataSource.unbind(N,_(n._error,n))),r.fields||(r.fields=[{field:"text"},{field:"url"},{field:"spriteCssClass"},{field:"imageUrl"}]),n.dataSource=r=v.create(r),e&&(r.fetch(),t(r.view())),r.bind(T,_(n.refresh,n)),r.bind(N,_(n._error,n))},events:[B,A,U,D,H,w,I,C,T,y],options:{name:"TreeView",dataSource:{},animation:{expand:{effects:"expand:vertical",duration:200},collapse:{duration:100}},dragAndDrop:!1,checkboxes:!1,autoBind:!0,loadOnDemand:!0,template:"",dataTextField:null},_accessors:function(){var e,t,n,i=this,r=i.options,a=i.element;for(e in P)t=r[P[e]],n=a.attr(u.attr(e+"-field")),!t&&n&&(t=n),t||(t=e),m(t)||(t=[t]),r[P[e]]=t},_fieldAccessor:function(t){var n=this.options[P[t]],i=n.length,r="(function(item) {";return 0===i?r+="return item['"+t+"'];":(r+="var level = item.level();var levels = ["+e.map(n,function(e){return"function(d){ return "+u.expr(e)+"}"}).join(",")+"];",r+="return levels[Math.min(level, "+i+"-1)](item)"),r+="})"},setOptions:function(e){var t=this;"dragAndDrop"in e&&e.dragAndDrop&&!t.options.dragAndDrop&&(t.dragging=new s(t)),k.fn.setOptions.call(t,e),t._animation(),t._templates()},_trigger:function(e,t){return this.trigger(e,{node:t.closest(M)[0]})},_setChecked:function(t,n){if(t&&e.isFunction(t.view))for(var i=0,r=t.view();r.length>i;i++)r[i][S]=n,r[i].children&&this._setChecked(r[i].children,n)},_setIndeterminate:function(e){var t,n,r,a=d(e),s=!0;if(a.length){if(t=i(a.children()),n=t.length,n>1){for(r=1;n>r;r++)if(t[r].checked!=t[r-1].checked||t[r].indeterminate||t[r-1].indeterminate){s=!1;break}}else s=!t[0].indeterminate;i(e).data("indeterminate",!s).prop("indeterminate",!s).prop(S,s&&t[0].checked)}},_updateIndeterminateInitial:function(e){var t,n=d(e).children();if(n.length){for(t=0;n.length>t;t++)this._updateIndeterminateInitial(n.eq(t));this._setIndeterminate(e)}},_updateIndeterminate:function(e){var t,n=this.parent(e);n.length&&(this._setIndeterminate(n),t=n.children("div").find(".k-checkbox :checkbox"),t.prop("indeterminate")===!1?this.dataItem(n).set(S,t.prop(S)):this.dataItem(n).checked=!1,this._updateIndeterminate(n))},_checkboxChange:function(t){var n=e(t.target),i=n.prop(S),r=n.closest(M),a=this;a.dataItem(r).set(S,i)},_toggleButtonClick:function(t){this.toggle(e(t.target).closest(M))},_mousedown:function(t){var n=e(t.currentTarget).closest(M);this._clickTarget=n,this.current(n)},_focusable:function(e){return e&&e.length&&e.is(":visible")&&!e.find(".k-in:first").hasClass("k-state-disabled")},_focus:function(){var t=this.select(),n=this._clickTarget;u.support.touch||(n&&n.length&&(t=n),this._focusable(t)||(t=this.current()),this._focusable(t)||(t=this._nextVisible(e())),this.current(t))},focus:function(){var e,t=this.wrapper,n=t[0],i=[],r=[],a=document.documentElement;do n=n.parentNode,n.scrollHeight>n.clientHeight&&(i.push(n),r.push(n.scrollTop));while(n!=a);for(t.focus(),e=0;i.length>e;e++)i[e].scrollTop=r[e]},_blur:function(){this.current().find(".k-in:first").removeClass("k-state-focused")},_enabled:function(e){return!e.children("div").children(".k-in").hasClass("k-state-disabled")},parent:function(t){var n,i,r=/\bk-treeview\b/,a=/\bk-item\b/;typeof t==R&&(t=this.element.find(t)),Q(t)||(t=t[0]),i=a.test(t.className);do t=t.parentNode,a.test(t.className)&&(i?n=t:i=!0);while(!r.test(t.className)&&!n);return e(n)},_nextVisible:function(e){var t,n=this,i=n._expanded(e);if(e.length&&e.is(":visible"))if(i)t=d(e).children().first();else{for(;e.length&&!e.next().length;)e=n.parent(e);t=e.next().length?e.next():e}else t=n.root.children().eq(0);return n._enabled(t)||(t=n._nextVisible(t)),t},_previousVisible:function(e){var t,n=this;if(!e.length||e.prev().length)for(t=e.length?e.prev():n.root.children().last();n._expanded(t);)t=d(t).children().last();else t=n.parent(e)||e;return n._enabled(t)||(t=n._previousVisible(t)),t},_keydown:function(n){var i,r=this,a=n.keyCode,s=r.current(),o=r._expanded(s),d=s.find(".k-checkbox:first :checkbox"),l=u.support.isRtl(r.element);n.target==n.currentTarget&&(!l&&a==b.RIGHT||l&&a==b.LEFT?o?i=r._nextVisible(s):r.expand(s):!l&&a==b.LEFT||l&&a==b.RIGHT?o?r.collapse(s):(i=r.parent(s),r._enabled(i)||(i=t)):a==b.DOWN?i=r._nextVisible(s):a==b.UP?i=r._previousVisible(s):a==b.HOME?i=r._nextVisible(e()):a==b.END?i=r._previousVisible(e()):a==b.ENTER?s.find(".k-in:first").hasClass("k-state-selected")||r._trigger(C,s)||r.select(s):a==b.SPACEBAR&&d.length&&(d.prop(S,!d.prop(S)).data("indeterminate",!1).prop("indeterminate",!1),r._checkboxChange({target:d}),i=s),i&&(n.preventDefault(),s[0]!=i[0]&&(r._trigger(y,i),r.current(i))))},_click:function(t){var n,i=this,r=e(t.target),a=l(r.closest(M)),s=r.attr("href");n=s?"#"==s||s.indexOf("#"+this.element.id+"-")>=0:a.length&&!a.children().length,n&&t.preventDefault(),r.hasClass(".k-state-selected")||i._trigger(C,r)||i.select(r)},_wrapper:function(){var e,t,n=this,i=n.element,r="k-widget k-treeview";i.is("div")?(e=i,t=e.children("ul").eq(0)):(e=i.wrap("<div />").parent(),t=i),n.wrapper=e.addClass(r),n.root=t},_group:function(e){var t=this,n=e.hasClass(q),i={firstLevel:n,expanded:n||t._expanded(e)},r=e.children("ul");r.addClass(t.templates.groupCssClass(i)).css("display",i.expanded?"":"none"),t._nodes(r,i)},_nodes:function(t,n){var i,r=this,s=t.children("li");n=f({length:s.length},n),s.each(function(t,s){s=e(s),i={index:t,expanded:r._expanded(s)},a(s),r._updateNodeClasses(s,n,i),r._group(s)})},_checkboxes:function(){var e,t=this.options,n=t.checkboxes;(n||t.checkboxTemplate)&&(t.checkboxTemplate?e=t.checkboxTemplate:(e="<input type='checkbox' #= (item.enabled === false) ? 'disabled' : '' # #= item.checked ? 'checked' : '' #",n.name&&(e+=" name='"+n.name+"'"),e+=" />"),n=f({template:e},t.checkboxes),typeof n.template==R&&(n.template=g(n.template)),t.checkboxes=n)},_updateNodeClasses:function(e,t,n){var i=e.children("div"),r=e.children("ul"),a=this.templates;e.hasClass("k-treeview")||(n=n||{},n.expanded=typeof n.expanded!=L?n.expanded:this._expanded(e),n.index=typeof n.index!=L?n.index:e.index(),n.enabled=typeof n.enabled!=L?n.enabled:!i.children(".k-in").hasClass("k-state-disabled"),t=t||{},t.firstLevel=typeof t.firstLevel!=L?t.firstLevel:e.parent().parent().hasClass(q),t.length=typeof t.length!=L?t.length:e.parent().children().length,e.removeClass("k-first k-last").addClass(a.wrapperCssClass(t,n)),i.removeClass("k-top k-mid k-bot").addClass(a.cssClass(t,n)),i.children(".k-in").removeClass("k-in k-state-default k-state-disabled").addClass(a.textClass(n)),(r.length||"true"==e.attr("data-hasChildren"))&&(i.children(".k-icon").removeClass("k-plus k-minus k-plus-disabled k-minus-disabled").addClass(a.toggleButtonClass(n)),r.addClass("k-group")))},_processNodes:function(t,n){var i=this;i.element.find(t).each(function(t,r){n.call(i,t,e(r).closest(M))})},dataItem:function(t){var n=e(t).closest(M).attr(u.attr("uid")),i=this.dataSource;return i&&i.getByUid(n)},_insertNode:function(t,n,i,r,s){var o,l,c,u,p=this,h=d(i),f=h.children().length+1,g={firstLevel:i.hasClass(q),expanded:!s,length:f},m="",k=function(e,t){e.appendTo(t)};for(c=0;t.length>c;c++)u=t[c],u.index=n+c,m+=p._renderItem({group:g,item:u});if(l=e(m),l.length){for(h.length||(h=e(p._renderGroup({group:g})).appendTo(i)),r(l,h),i.hasClass("k-item")&&(a(i),p._updateNodeClasses(i)),p._updateNodeClasses(l.prev().first()),p._updateNodeClasses(l.next().last()),c=0;t.length>c;c++)u=t[c],u.hasChildren&&(o=u.children.data(),o.length&&p._insertNode(o,u.index,l.eq(c),k,!p._expanded(l.eq(c))));return l}},_updateNode:function(t,n){function i(){h=!0}function r(e,t){e.find(".k-checkbox :checkbox").prop(S,t).data("indeterminate",!1).prop("indeterminate",!1)}var a,s,o,d,c,u=this,p={treeview:u.options,item:o},h=!1;if("selected"==t)o=n[0],s=u.findByUid(o.uid).find(".k-in:first").removeClass("k-state-hover").toggleClass("k-state-selected",o[t]).end(),o[t]?(u.current(s),s.attr(j,!0)):s.attr(j,!1);else for(e.inArray(t,u.options.dataTextField)>=0?h=!0:(p.item=n[0],p.item.bind("get",i),u.templates.itemContent(p),p.item.unbind("set",i)),a=0;n.length>a;a++)p.item=o=n[a],"spriteCssClass"==t||"imageUrl"==t||h?u.findByUid(o.uid).find(">div>.k-in").html(u.templates.itemContent(p)):t==S?(s=u.findByUid(o.uid),d=o[t],r(s.children("div"),d),u.options.checkboxes.checkChildren&&(r(s.children(".k-group"),d),u._setChecked(o.children,d),u._updateIndeterminate(s))):"expanded"==t?u._toggle(u.findByUid(o.uid),o,o[t]):"enabled"==t&&(s=u.findByUid(o.uid),s.find(".k-checkbox :checkbox").prop("disabled",!o[t]),c=!l(s).is(F),s.removeAttr(G),o[t]||(o.selected&&o.set("selected",!1),o.expanded&&o.set("expanded",!1),c=!0,s.removeAttr(j).attr(G,!0)),u._updateNodeClasses(s,{},{enabled:o[t],expanded:!c}))},refresh:function(e){function n(e,t){var n=d(t),i=n.children(),a=!r._expanded(t);typeof u==L&&(u=i.length),r._insertNode(e,u,t,function(e,t){u==i.length?e.appendTo(t):e.insertBefore(i.eq(u))},a),r._expanded(t)&&(r._updateNodeClasses(t),d(t).css("display","block"))}var i,r=this,s=r.wrapper,o=e.node,l=e.action,c=e.items,u=e.index,p=r.options,h=p.loadOnDemand,f=p.checkboxes&&p.checkboxes.checkChildren;if(e.field)return r._updateNode(e.field,c);if(o&&(s=r.findByUid(o.uid),r._progress(s,!1)),f&&"remove"!=l&&o&&o.checked)for(i=0;c.length>i;i++)c[i].checked=!0;for("add"==l?n(c,s):"remove"==l?r._remove(r.findByUid(c[0].uid),!1):o?(d(s).empty(),c.length?n(c,s):a(s)):r.root=r.wrapper.html(r._renderGroup({items:c,group:{firstLevel:!0,expanded:!0}})).children("ul"),i=0;c.length>i;i++)(!h||c[i].expanded)&&c[i].load();r.trigger(H,{node:o?s:t})},_error:function(e){var t=this,n=e.node&&t.findByUid(e.node.uid);n?(this._progress(n,!1),c(n).addClass("k-i-refresh"),e.node.loaded(!1)):(this._progress(!1),this.element.html(this.templates.retry))},_retryRequest:function(e){e.preventDefault(),this.dataSource.fetch()},expand:function(e){this._processNodes(e,function(e,t){this.toggle(t,!0)})},collapse:function(e){this._processNodes(e,function(e,t){this.toggle(t,!1)})},enable:function(e,t){t=2==arguments.length?!!t:!0,this._processNodes(e,function(e,n){this.dataItem(n).set("enabled",t)})},current:function(n){var i=this,r=i._current,a=i.element,s=i._ariaId;return arguments.length>0&&n&&n.length?(r&&(r[0].id===s&&r.removeAttr("id"),r.find(".k-in:first").removeClass("k-state-focused")),r=i._current=e(n,a).closest(M),r.find(".k-in:first").addClass("k-state-focused"),s=r[0].id||s,s&&(i.wrapper.removeAttr("aria-activedescendant"),r.attr("id",s),i.wrapper.attr("aria-activedescendant",s)),t):(r||(r=i._nextVisible(e())),r)},select:function(n){var i=this,r=i.element;return arguments.length?(n=e(n,r).closest(M),r.find(".k-state-selected").each(function(){var e=i.dataItem(this);e.set("selected",!1),delete e.selected}),n.length&&i.dataItem(n).set("selected",!0),i.trigger(T),t):r.find(".k-state-selected").closest(M)},_toggle:function(e,t,n){var i,r=this,a=r.options,s=l(e),o=n?"expand":"collapse",d=a.animation[o];if(!s.data("animating")&&!r._trigger(o,e))if(r._expanded(e,n),i=t&&t.loaded(),i&&s.children().length>0){if(r._updateNodeClasses(e,{},{expanded:n}),s.css("display")==(n?"block":"none"))return;n||s.css("height",s.height()).css("height"),s.kendoStop(!0,!0).kendoAnimate(f({reset:!0},d,{complete:function(){n&&s.css("height","")}}))}else(!i||i&&n)&&(a.loadOnDemand&&r._progress(e,!0),s.remove(),t.load())},toggle:function(t,n){t=e(t),c(t).is(".k-minus,.k-plus,.k-minus-disabled,.k-plus-disabled")&&(1==arguments.length&&(n=!this._expanded(t)),this._expanded(t,n))},destroy:function(){var e=this;k.fn.destroy.call(e),e.element.off(x),e.dragging&&e.dragging.destroy(),u.destroy(e.element)},_expanded:function(e,n){var i=u.attr("expanded"),r=this.dataItem(e);return 1==arguments.length?"true"===e.attr(i)||r&&r.expanded:(l(e).data("animating")||(r&&r.set("expanded",n),n?(e.attr(i,"true"),e.attr("aria-expanded","true")):(e.removeAttr(i),e.attr("aria-expanded","false"))),t)},_progress:function(e,t){var n=this.element;1==arguments.length?(t=e,t?n.html(this.templates.loading):n.empty()):c(e).toggleClass("k-loading",t)},text:function(e,n){var i=this.dataItem(e),r=this.options[P.text],a=i.level(),s=r.length,o=r[Math.min(a,s-1)];return n?(i.set(o,n),t):i[o]},_objectOrSelf:function(t){return e(t).closest("[data-role=treeview]").data("kendoTreeView")||this},_dataSourceMove:function(e,t,n,i){var r,a=this._objectOrSelf(n||t),s=a.dataSource;return n&&n[0]!=a.element[0]&&(r=a.dataItem(n),r.loaded()||(a._progress(n,!0),r.load()),n!=this.root&&(s=r.children,s&&s instanceof v||(r._initChildren(),r.loaded(!0),s=r.children))),e=this._toObservableData(e),i.call(this,s,e)},_toObservableData:function(t){var n,i,r=t;return(t instanceof window.jQuery||Q(t))&&(n=this._objectOrSelf(t).dataSource,i=e(t).attr(u.attr("uid")),r=n.getByUid(i),r&&(r=n.remove(r))),r},_insert:function(e,t,n){t instanceof u.data.ObservableArray?t=t.toJSON():m(t)||(t=[t]);var i=e.parent();return i&&(i.hasChildren=!0,i._initChildren()),e.splice.apply(e,[n,0].concat(t)),this.findByUid(e[n].uid)},insertAfter:r(1),insertBefore:r(0),append:function(e,t){var n=this,i=n.root;return t&&(i=d(t)),n._dataSourceMove(e,i,t,function(e,i){function r(){t&&n._expanded(t,!0);var r=e.data(),a=Math.max(r.length,0);return n._insert(r,i,a)}return e.data()?r():(e.one(T,r),null)})},_remove:function(t,n){var i,r,s,o=this;return t=e(t,o.element),i=t.parent().parent(),r=t.prev(),s=t.next(),t[n?"detach":"remove"](),i.hasClass("k-item")&&(a(i),o._updateNodeClasses(i)),o._updateNodeClasses(r),o._updateNodeClasses(s),t},remove:function(e){var t=this.dataItem(e);t&&this.dataSource.remove(t)},detach:function(e){return this._remove(e,!0)},findByText:function(t){return e(this.element).find(".k-in").filter(function(n,i){return e(i).text()==t}).closest(M)},findByUid:function(e){return this.element.find(".k-item["+u.attr("uid")+"="+e+"]")},_renderItem:function(e){return e.group||(e.group={}),e.treeview=this.options,e.r=this.templates,this.templates.item(e)},_renderGroup:function(e){var t=this;return e.renderItems=function(e){var n="",i=0,r=e.items,a=r?r.length:0,s=e.group;for(s.length=a;a>i;i++)e.group=s,e.item=r[i],e.item.index=i,n+=t._renderItem(e);return n},e.r=t.templates,t.templates.group(e)}}),s.prototype={_removeTouchHover:function(){var e=this;u.support.touch&&e.hovered&&(e.hovered.find("."+E).removeClass(E),e.hovered=!1)},_hintStatus:function(n){var i=this._draggable.hint.find(".k-drag-status")[0];return n?(i.className="k-icon k-drag-status "+n,t):e.trim(i.className.replace(/k-(icon|drag-status)/g,""))},dragstart:function(t){var n=this,i=n.treeview,r=n.sourceNode=t.currentTarget.closest(M);i.trigger(B,{sourceNode:r[0]})&&t.preventDefault(),n.dropHint=e("<div class='k-drop-hint' />").css(V,"hidden").appendTo(i.element)},drag:function(t){var n,i,r,a,s,o,d,l,c,p,h=this,f=h.treeview,g=h.sourceNode,m=h.dropTarget=e(u.eventTarget(t)),k=m.closest(".k-treeview");k.length?e.contains(g[0],m[0])?n="k-denied":(n="k-insert-middle",i=m.closest(".k-top,.k-mid,.k-bot"),i.length?(a=i.outerHeight(),s=u.getOffset(i).top,o=m.closest(".k-in"),d=a/(o.length>0?4:2),l=s+d>t.y.location,c=t.y.location>s+a-d,h._removeTouchHover(),p=o.length&&!l&&!c,h.hovered=p?k:!1,h.dropHint.css(V,p?"hidden":"visible"),o.toggleClass(E,p),p?n="k-add":(r=i.position(),r.top+=l?0:a,h.dropHint.css(r)[l?"prependTo":"appendTo"](m.closest(M).children("div:first")),l&&i.hasClass("k-top")&&(n="k-insert-top"),c&&i.hasClass("k-bot")&&(n="k-insert-bottom"))):m[0]!=h.dropHint[0]&&(n=k[0]!=f.element[0]?"k-add":"k-denied")):(n="k-denied",h._removeTouchHover()),f.trigger(A,{sourceNode:g[0],dropTarget:m[0],pageY:t.y.location,pageX:t.x.location,statusClass:n.substring(2),setStatusClass:function(e){n=e}}),0!==n.indexOf("k-insert")&&h.dropHint.css(V,"hidden"),h._hintStatus(n)},dragcancel:function(){this.dropHint.remove()},dragend:function(){var e,n,i,r=this,a=r.treeview,s="over",o=r.sourceNode,d=r.dropHint,l=r.dropTarget;return"visible"==d.css(V)?(s=d.prevAll(".k-in").length>0?"after":"before",e=d.closest(M)):l&&(e=l.closest(M),e.length||(e=l.closest(".k-treeview"))),n="k-denied"!=r._hintStatus(),i=a.trigger(U,{sourceNode:o[0],destinationNode:e[0],valid:n,setValid:function(e){n=e},dropTarget:l[0],dropPosition:s}),d.remove(),r._removeTouchHover(),!n||i?(r._draggable.dropped=n,t):(r._draggable.dropped=!0,"over"==s?o=a.append(o,e):"before"==s?o=a.insertBefore(o,e):"after"==s&&(o=a.insertAfter(o,e)),a.trigger(D,{sourceNode:o&&o[0],destinationNode:e[0],dropPosition:s}),t)},destroy:function(){this._draggable.destroy()}},p.plugin(o)})(window.kendo.jQuery)});