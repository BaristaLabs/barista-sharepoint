/*
* Kendo UI Web v2012.2.913 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Web commercial licenses may be obtained at
* https://www.kendoui.com/purchase/license-agreement/kendo-ui-web-commercial.aspx
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3.
* For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
*/
;(function(a,b){var c=window.kendo,d=c.ui,e=d.List,f=d.Select,g=c.support,h=g.placeholder,i=f.removeFiltersForField,j=c.keys,k=".kendoComboBox",l=(g.touch?"touchend":"click")+k,m="disabled",n="change",o="k-state-default",p="k-state-disabled",q="k-state-focused",r="mousedown"+k,s="select",t="k-state-selected",u="filter",v="accept",w="rebind",x="mouseenter"+k+" mouseleave"+k,y=null,z=a.proxy,A=f.extend({init:function(b,d){var e=this,g,h;e.ns=k,d=a.isArray(d)?{dataSource:d}:d,f.fn.init.call(e,b,d),e._focusHandler=function(){e.input.focus()},d=e.options,b=e.element.on("focus"+k,e._focusHandler),d.placeholder=d.placeholder||b.attr("placeholder"),e._reset(),e._wrapper(),e._input(),e._popup(),e._accessors(),e._dataSource(),e._enable(),e._cascade(),g=e._inputWrapper,e.input.on("keydown"+k,z(e._keydown,e)).on("focus"+k,function(){g.addClass(q),e._placeholder(!1)}).on("blur"+k,function(){g.removeClass(q),clearTimeout(e._typing),e.options.text!==e.input.val()&&e.text(e.text()),e._placeholder(),e._blur(),b.blur()}),e._oldIndex=e.selectedIndex=-1,e._old=e.value(),d.autoBind?e._filterSource():(h=d.text,!h&&b.is(s)&&(h=b.children(":selected").text()),h&&e.input.val(h)),h||e._placeholder(),c.notify(e)},options:{name:"ComboBox",enable:!0,index:-1,autoBind:!0,delay:200,dataTextField:"",dataValueField:"",minLength:0,height:200,highlightFirst:!0,template:"",filter:"none",placeholder:"",suggest:!1,ignoreCase:!0,animation:{}},events:["open","close",n,"select","dataBinding","dataBound"],setOptions:function(a){f.fn.setOptions.call(this,a),this._template(),this._accessors()},current:function(a){var c=this,d=c._current;if(a===b)return d;d&&d.removeClass(t),f.fn.current.call(c,a)},destroy:function(){var a=this;a.input.off(k),a.element.off(k),a._inputWrapper.off(k),f.fn.destroy.call(a)},enable:function(a){var b=this,c=b.input.add(b.element),d=b._inputWrapper.off(x),e=b._arrow.parent().off(l+" "+r);a===!1?(d.removeClass(o).addClass(p),c.attr(m,m)):(d.removeClass(p).addClass(o).on(x,b._toggleHover),c.removeAttr(m),e.on(l,function(){b.toggle()}).on(r,function(a){a.preventDefault()}))},open:function(){var a=this,b=a.dataSource.options.serverFiltering;a.popup.visible()||(!a.ul[0].firstChild||a._state===v&&!b?(a._open=!0,a._state=w,a._filterSource()):(a.popup.open(),a._scroll(a._current)))},refresh:function(){var d=this,e=d.ul[0],f=d.options,g=d._state,h=d._data(),i=h.length,j,k;d.trigger("dataBinding"),e.innerHTML=c.render(d.template,h),d._height(i),d.popup.visible()&&d.popup._position(),d.element.is(s)&&(g===w&&(j=d.value(),d._state=""),d._option=b,d._options(h)),i&&(f.highlightFirst&&d.current(a(e.firstChild)),f.suggest&&d.input.val()&&d._valueCalled!==b&&d.suggest(a(e.firstChild))),d._open&&(d._open=!1,k=!!i,d._typing&&d.input[0]!==document.activeElement&&(k=!1),d.toggle(k),d._typing=b),d._touchScroller&&d._touchScroller.reset(),d._makeUnselectable(),!d._valueCalled&&g!==u&&(d._selectItem(j),d._valueCalled=!1),d._hideBusy(),d.trigger("dataBound")},select:function(a){var c=this;if(a===b)return c.selectedIndex;c._select(a),c._old=c._accessor(),c._oldIndex=c.selectedIndex},search:function(a){a=typeof a=="string"?a:this.text();var b=this,c=a.length,d=b.options,e=d.ignoreCase,f=d.filter,g=d.dataTextField;clearTimeout(b._typing),c>=d.minLength&&(f==="none"?b._filter(a):(b._open=!0,b._state=u,b._filterSource({value:e?a.toLowerCase():a,field:g,operator:f,ignoreCase:e})))},suggest:function(a){var c=this,d=c.input[0],f=c.text(),g=e.caret(d),h=c._last,i;if(h==j.BACKSPACE||h==j.DELETE)c._last=b;else{a=a||"",typeof a!="string"&&(i=e.inArray(a[0],c.ul[0]),i>-1?a=c._text(c.dataSource.view()[i]):a=""),g<=0&&(g=f.toLowerCase().indexOf(a.toLowerCase())+1),a?(i=a.toLowerCase().indexOf(f.toLowerCase()),i>-1&&(f+=a.substring(i+f.length))):f=f.substring(0,g);if(f.length!==g||!a)d.value=f,e.selectText(d,g,f.length)}},text:function(a){a=a===null?"":a;var c=this,d=c._text,e=c.input[0],f=c.options.ignoreCase,g=a,h;if(a===b)return e.value;h=c.dataItem();if(!h||d(h)!==a)f&&(g=g.toLowerCase()),c._select(function(a){a=d(a),f&&(a=(a+"").toLowerCase());return a===g}),c.selectedIndex<0&&(c._custom(a),e.value=a)},toggle:function(a){var b=this;b._toggle(a)},value:function(a){var c=this,d;if(a===b)return c._accessor();a!==null&&(a=a.toString()),c._valueCalled=!0;if(!a||!c._valueOnFetch(a))d=c._index(a),d>-1?c.select(d):(c.current(y),c._custom(a),c.text(a),c._placeholder()),c._old=c._accessor(),c._oldIndex=c.selectedIndex},_accept:function(a){var b=this;a&&b.popup.visible()?(b._state===u&&(b._state=v),b._focus(a)):(b.text(b.text()),b._change())},_custom:function(b){var c=this,d=c.element,e=c._option;d.is(s)?(e||(e=c._option=a("<option/>"),d.append(e)),e.text(b),e[0].selected=!0):d.val(b)},_filter:function(a){var c=this,d=c.options,e=c.dataSource,f=d.ignoreCase,g=function(d){var e=c._text(d);if(e!==b){e=e+"";if(e!==""&&a==="")return!1;f&&(e=e.toLowerCase());return e.indexOf(a)===0}};f&&(a=a.toLowerCase());c.ul[0].firstChild?(c._highlight(g)!==-1&&(d.suggest&&c._current&&c.suggest(c._current),c.open()),c._hideBusy()):e.one(n,function(){e.data()[0]&&c.search(a)}).fetch()},_highlight:function(c){var d=this,f;if(c===b||c===null)return-1;c=d._get(c),f=e.inArray(c[0],d.ul[0]),f==-1&&(d.options.highlightFirst&&!d.text()?c=a(d.ul[0].firstChild):c=y),d.current(c);return f},_input:function(){var b=this,c=b.element[0],d=c.tabIndex,e=b.wrapper,f=".k-input",g,i,j=c.name||"";j&&(j='name="'+j+'_input" '),g=e.find(f),g[0]||(e.append('<span unselectable="on" class="k-dropdown-wrap k-state-default"><input '+j+'class="k-input" type="text" autocomplete="off"/><span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span></span>').append(b.element),g=e.find(f)),i=g[0],i.tabIndex=d,i.style.cssText=c.style.cssText,c.maxLength>-1&&(i.maxLength=c.maxLength),g.addClass(c.className).val(c.value).css({width:"100%",height:c.style.height}).show(),h&&g.attr("placeholder",b.options.placeholder),b._focused=b.input=g,b._arrow=e.find(".k-icon"),b._inputWrapper=a(e[0].firstChild)},_keydown:function(a){var b=this,c=a.keyCode;b._last=c,clearTimeout(b._typing),c!=j.TAB&&!b._move(a)&&b._search()},_placeholder:function(a){if(!h){var c=this,d=c.input,e=c.options.placeholder,f;if(e){f=c.value(),a===b&&(a=!f),d.toggleClass("k-readonly",a);if(!a)if(!f)e="";else return;d.val(e)}}},_search:function(){var a=this;a._typing=setTimeout(function(){var b=a.text();a._prev!==b&&(a._prev=b,a.search(b))},a.options.delay)},_select:function(a){var c=this,d,e,f=c._highlight(a),g=c._data();c.selectedIndex=f,f!==-1&&(c._current.addClass(t),g=g[f],d=c._text(g),e=c._value(g),c._prev=c.input[0].value=d,c._accessor(e!==b?e:d,f),c._placeholder())},_filterSource:function(a){var b=this,c=b.options,d=b.dataSource,e=d.filter()||{};i(e,c.dataTextField),a&&(e=e.filters||[],e.push(a)),d.filter(e)},_wrapper:function(){var a=this,b=a.element,c=b.parent();c.is("span.k-widget")||(c=b.hide().wrap("<span />").parent()),c[0].style.cssText=b[0].style.cssText,a.wrapper=c.addClass("k-widget k-combobox k-header").addClass(b[0].className).show()}});d.plugin(A)})(jQuery);