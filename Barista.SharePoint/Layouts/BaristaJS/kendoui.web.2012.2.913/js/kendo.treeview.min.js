/*
* Kendo UI Web v2012.2.913 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Web commercial licenses may be obtained at
* https://www.kendoui.com/purchase/license-agreement/kendo-ui-web-commercial.aspx
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3.
* For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
*/
;(function(a,b){function M(a){var b=this;b.treeview=a,b.hovered=a.element,b._draggable=new d.Draggable(a.element,{filter:"div:not(.k-state-disabled) .k-in",hint:function(b){return a.templates.dragClue({text:b.text()})},cursorOffset:{left:10,top:c.support.touch?-40/c.support.zoomLevel():10},dragstart:k(b.dragstart,b),dragcancel:k(b.dragcancel,b),drag:k(b.drag,b),dragend:k(b.dragend,b)})}function L(b){var c=b.children("div"),d=b.children("ul"),e=c.children(".k-icon"),f=c.children(".k-in"),g,h;if(!b.hasClass("k-treeview")){c.length||(c=a("<div />").prependTo(b));if(!e.length&&d.length)e=a("<span class='k-icon' />").prependTo(c);else if(!d.length||!d.children().length)e.remove(),d.remove();if(!f.length){f=a("<span class='k-in' />").appendTo(c)[0],g=c[0].nextSibling,f=c.find(".k-in")[0];while(g&&g.nodeName.toLowerCase()!="ul")h=g,g=g.nextSibling,h.nodeType==3&&(h.nodeValue=a.trim(h.nodeValue)),f.appendChild(h)}}}function K(a){return a.children("div").find(":checkbox:first")}function J(a){return function(b){var c=b.children(".k-animation-container");c.length||(c=b);return c.children(a)}}var c=window.kendo,d=c.ui,e=c.data,f=a.extend,g=c.template,h=a.isArray,i=d.Widget,j=e.HierarchicalDataSource,k=a.proxy,l=".kendoTreeView",m="select",n="expand",o="change",p="checked",q="collapse",r="dragstart",s="drag",t="drop",u="dragend",v="dataBound",w="click",x="visibility",y="undefined",z="k-state-hover",A="k-treeview",B=":visible",C=".k-item",D,E,F,G,H={text:"dataTextField",url:"dataUrlField",spriteCssClass:"dataSpriteCssClassField",imageUrl:"dataImageUrlField"},I=function(a){return typeof HTMLElement=="object"?a instanceof HTMLElement:a&&typeof a=="object"&&a.nodeType===1&&typeof a.nodeName=="string"};F=J(".k-group"),G=J(".k-group,.k-content"),E=i.extend({init:function(a,b){var c=this,d,e=!1;h(b)&&(d=!0,b={dataSource:b}),b&&typeof b.loadOnDemand==y&&h(b.dataSource)&&(b.loadOnDemand=!1),i.prototype.init.call(c,a,b),a=c.element,b=c.options,e=a.is("ul")||a.hasClass(A),e&&(b.dataSource.list=a.is("ul")?a:a.children("ul")),c._animation(),c._accessors(),c._templates(),a.hasClass(A)?(c.wrapper=a,c.root=a.children("ul").eq(0)):(c._wrapper(),e&&(c.root=a,c._group(c.wrapper))),c._dataSource(e),c._attachEvents(),b.dragAndDrop&&(c.dragging=new M(c)),e?c._attachUids():b.autoBind&&(c._progress(!0),c.dataSource.read())},_attachEvents:function(){var b=this,c=".k-in:not(.k-state-selected,.k-state-disabled)",d="mouseenter";b.wrapper.on(d+l,".k-in.k-state-selected",function(a){a.preventDefault()}).on(d+l,c,function(){a(this).addClass(z)}).on("mouseleave"+l,c,function(){a(this).removeClass(z)}).on(w+l,c,k(b._nodeClick,b)).on("dblclick"+l,"div:not(.k-state-disabled) .k-in",k(b._toggleButtonClick,b)).on(w+l,".k-plus,.k-minus",k(b._toggleButtonClick,b)).on("change"+l,".k-checkbox :checkbox",k(b._checkboxChange,b)).on("click"+l,".k-checkbox :checkbox",k(b._checkboxClick,b))},_checkboxClick:function(b){var c=a(b.target);c.data("indeterminate")&&(c.data("indeterminate",!1).prop("indeterminate",!1).prop(p,!0),this._checkboxChange(b))},_attachUids:function(b,d){var e=this,f,g=c.attr("uid");b=b||e.root,d=d||e.dataSource,f=d.view(),b.children("li").each(function(b,c){c=a(c).attr(g,f[b].uid),e._attachUids(c.children("ul"),f[b].children)})},_animation:function(){var a=this.options,b=a.animation;if(b===!1)b={expand:{show:!0,effects:{}},collapse:{hide:!0,effects:{}}};else if(!b.collapse||!("effects"in b.collapse))b.collapse=f({reverse:!0},b.expand);f(b.collapse,{show:!1,hide:!0}),a.animation=b},_templates:function(){var a=this,b=a.options;b.template&&typeof b.template=="string"?b.template=g(b.template):b.template||(b.template=a._textTemplate()),a._checkboxes(),a.templates={dragClue:g("<div class='k-header k-drag-clue'><span class='k-icon k-drag-status'></span>#= text #</div>"),group:g("<ul class='#= r.groupCssClass(group) #'#= r.groupAttributes(group) #>#= renderItems(data) #</ul>"),item:a._itemTemplate(),loading:a._loadingTemplate()}},items:function(){return this.element.find(".k-item")},setDataSource:function(a){this.options.dataSource=a,this._dataSource(),this.dataSource.read()},_dataSource:function(a){function e(a){for(var b=0;b<a.length;b++)a[b]._initChildren(),a[b].children.read(),e(a[b].children.view())}var b=this,c=b.options,d=c.dataSource;d=h(d)?{data:d}:d,b.dataSource&&b._refreshHandler?b.dataSource.unbind(o,b._refreshHandler):b._refreshHandler=k(b.refresh,b),d.fields||(d.fields=[{field:"text"},{field:"url"},{field:"spriteCssClass"},{field:"imageUrl"}]),b.dataSource=j.create(d),a&&(b.dataSource.read(),e(b.dataSource.view())),b.dataSource.bind(o,b._refreshHandler)},events:[r,s,t,u,v,n,q,m],options:{name:"TreeView",dataSource:{},animation:{expand:{effects:"expand:vertical",duration:200,show:!0},collapse:{duration:100}},dragAndDrop:!1,autoBind:!0,loadOnDemand:!0,template:""},_accessors:function(){var a=this,b=a.options,d,e,f,g=a.element;for(d in H)e=b[H[d]],f=g.attr(c.attr(d+"-field")),f&&(e=f),e||(e=d),h(e)||(e=[e]),b[H[d]]=e},_fieldAccessor:function(b){var d=this.options[H[b]],e=d.length,f="(function(item) {";e===0?f+="return item['"+b+"'];":(f+="var level = item.level();var levels = ["+a.map(d,function(a){return"function(d){ return "+c.expr(a)+"}"}).join(",")+"];",f+="return levels[level < "+e+" ? level : "+(e-1)+"](item)"),f+="})";return f},_textTemplate:function(){var a=this,b="# var text = "+a._fieldAccessor("text")+"(item); #"+"# if (typeof item.encoded != 'undefined' && item.encoded === false) {#"+"#= text #"+"# } else { #"+"#: text #"+"# } #";return g(b)},_loadingTemplate:function(){return g("<div class='k-icon k-loading' /> Loading...")},_itemTemplate:function(){var a=this,b="# var url = "+a._fieldAccessor("url")+"(item); #"+"# var imageUrl = "+a._fieldAccessor("imageUrl")+"(item); #"+"# var spriteCssClass = "+a._fieldAccessor("spriteCssClass")+"(item); #"+"<li class='#= r.wrapperCssClass(group, item) #'"+" "+c.attr("uid")+"='#= item.uid #'"+">"+"<div class='#= r.cssClass(group, item) #'>"+"# if (item.hasChildren) { #"+"<span class='#= r.toggleButtonClass(item) #'></span>"+"# } #"+"# if (treeview.checkboxes) { #"+"<span class='k-checkbox'>"+"#= treeview.checkboxes.template(data) #"+"</span>"+"# } #"+"# var tag = url ? 'a' : 'span'; #"+"# var textAttr = url ? ' href=\\'' + url + '\\'' : ''; #"+"<#=tag# class='#= r.textClass(item) #'#= textAttr #>"+"# if (imageUrl) { #"+"<img class='k-image' alt='' src='#= imageUrl #'>"+"# } #"+"# if (spriteCssClass) { #"+"<span class='k-sprite #= spriteCssClass #'></span>"+"# } #"+"#= treeview.template(data) #"+"</#=tag#>"+"</div>"+"</li>";return g(b)},setOptions:function(a){var b=this;"dragAndDrop"in a&&a.dragAndDrop&&!b.options.dragAndDrop&&(b.dragging=new M(b)),i.fn.setOptions.call(b,a),b._animation(),b._templates()},_trigger:function(a,b){return this.trigger(a,{node:b.closest(C)[0]})},_updateIndeterminate:function(a){var b=a.parent().closest(C),c,d,e=!0;if(b.length){c=K(a.siblings().andSelf());for(d=1;d<c.length;d++)if(c[d].checked!=c[d-1].checked||c[d].indeterminate||c[d-1].indeterminate){e=!1;break}K(b).data("indeterminate",!e).prop("indeterminate",!e).prop(p,e&&c[0].checked),this._updateIndeterminate(b)}},_checkboxChange:function(b){var c=a(b.target),d=c.prop(p),e=c.closest(C),f=this;f.options.checkboxes.checkChildren?(e.find(":checkbox").each(function(){f.dataItem(this).set(p,d)}),f._updateIndeterminate(e)):f.dataItem(e).set(p,d)},_toggleButtonClick:function(b){this.toggle(a(b.target).closest(C))},_nodeClick:function(b){var c=this,d=a(b.target),e=G(d.closest(C)),f=d.attr("href"),g;f?g=f=="#"||f.indexOf("#"+this.element.id+"-")>=0:g=e.length&&!e.children().length,g&&b.preventDefault(),!d.hasClass(".k-state-selected")&&!c._trigger("select",d)&&c.select(d)},_wrapper:function(){var a=this,b=a.element,c,d,e="k-widget k-treeview k-reset";b.is("div")?(c=b,d=c.children("ul").eq(0)):(c=b.wrap("<div />").parent(),d=b),a.wrapper=c.addClass(e),a.root=d},_group:function(a){var b=this,c=a.hasClass(A),d={firstLevel:c,expanded:c||b._expanded(a)},e=a.children("ul");e.addClass(D.groupCssClass(d)).css("display",d.expanded?"":"none"),b._nodes(e,d)},_nodes:function(b,c){var d=this,e=b.children("li"),g;c=f({length:e.length},c),e.each(function(b,e){e=a(e),g={index:b,expanded:d._expanded(e)},L(e),d._updateNodeClasses(e,c,g),d._group(e)})},_checkboxes:function(){var a=this,b=a.options,c=b.checkboxes;if(c||b.checkboxTemplate)c=f({template:b.checkboxTemplate||"<input type='checkbox' />"},b.checkboxes),typeof c.template=="string"&&(c.template=g(c.template)),b.checkboxes=c},_updateNodeClasses:function(a,b,c){var d=a.children("div"),e=a.children("ul");if(!a.hasClass("k-treeview")){c=c||{},c.expanded=typeof c.expanded!=y?c.expanded:this._expanded(a),c.index=typeof c.index!=y?c.index:a.index(),c.enabled=typeof c.enabled!=y?c.enabled:!d.children(".k-in").hasClass("k-state-disabled"),b=b||{},b.firstLevel=typeof b.firstLevel!=y?b.firstLevel:a.parent().parent().hasClass(A),b.length=typeof b.length!=y?b.length:a.parent().children().length,a.removeClass("k-first k-last").addClass(D.wrapperCssClass(b,c)),d.removeClass("k-top k-mid k-bot").addClass(D.cssClass(b,c)),d.children(".k-in").removeClass("k-in k-state-default k-state-disabled").addClass(D.textClass(c));if(e.length||a.attr("data-hasChildren")=="true")d.children(".k-icon").removeClass("k-plus k-minus k-plus-disabled k-minus-disabled").addClass(D.toggleButtonClass(c)),e.addClass("k-group")}},_processNodes:function(b,c){var d=this;d.element.find(b).each(function(b,e){c.call(d,b,a(e).closest(C))})},dataItem:function(b){var d=a(b).closest(C).attr(c.attr("uid")),e=this.dataSource;return e&&e.getByUid(d)},_insertNode:function(b,c,d,e,f){var g=this,h=F(d),i=h.children().length+1,j,k={firstLevel:d.hasClass(A),expanded:!f,length:i},l,m,n,o="",p=function(a,b){a.appendTo(b)};for(m=0;m<b.length;m++)n=b[m],n.index=c+m,o+=g._renderItem({group:k,item:n});l=a(o);if(!!l.length){h.length||(h=a(g._renderGroup({group:k})).appendTo(d)),e(l,h),d.hasClass("k-item")&&(L(d),g._updateNodeClasses(d)),g._updateNodeClasses(l.prev().first()),g._updateNodeClasses(l.next().last());for(m=0;m<b.length;m++)n=b[m],n.hasChildren&&(j=n.children.data(),j.length&&g._insertNode(j,n.index,l.eq(m),p,!g._expanded(l.eq(m))));return l}},_updateNode:function(b,c){var d=this,e,f;if(a.inArray(b,d.options.dataTextField)>=0)for(e=0;e<c.length;e++)f=d.findByUid(c[e].uid),d.text(f,c[e][b]);else if(b==p)for(e=0;e<c.length;e++)f=d.findByUid(c[e].uid),f.children("div").find(":checkbox").prop(p,c[e][b]).data("indeterminate",!1).prop("indeterminate",!1)},refresh:function(a){function k(a,b){var d=F(b),e=d.children(),f=!c._expanded(b);typeof h==y&&(h=e.length),c._insertNode(a,h,b,function(a,b){h==e.length?a.appendTo(b):a.insertBefore(e.eq(h))},f),c._expanded(b)&&(c._updateNodeClasses(b),F(b).css("display","block"))}var c=this,d=c.wrapper,e=a.node,f=a.action,g=a.items,h=a.index,i=c.options.loadOnDemand,j;if(a.field)return c._updateNode(a.field,g);e&&(d=c.findByUid(e.uid),c._progress(d,!1)),f=="add"?k(g,d):f=="remove"?c._remove(c.findByUid(g[0].uid),!1):e?(F(d).empty(),k(g,d)):c.root=c.wrapper.html(c._renderGroup({items:g,group:{firstLevel:!0,expanded:!0}})).children("ul");for(j=0;j<g.length;j++)(!i||g[j].expanded)&&g[j].load();c.trigger(v,{node:e?d:b})},expand:function(a){this._processNodes(a,function(a,b){this.toggle(b,!0)})},collapse:function(a){this._processNodes(a,function(a,b){this.toggle(b,!1)})},enable:function(a,b){b=arguments.length==2?!!b:!0,this._processNodes(a,function(a,c){var d=!G(c).is(B);b||(this.collapse(c),d=!0,c.find(".k-in:first").removeClass("k-state-selected")),this._updateNodeClasses(c,{},{enabled:b,expanded:!d})})},select:function(b){var c=this.element;if(!arguments.length)return c.find(".k-state-selected").closest(C);b=a(b,c).closest(C),b.length&&(c.find(".k-in").removeClass("k-state-hover k-state-selected"),b.find(".k-in:first").addClass("k-state-selected"))},toggle:function(b,c){b=a(b);if(!!b.find(">div>.k-icon").is(".k-minus,.k-plus,.k-minus-disabled,.k-plus-disabled")){var d=this,e=d.options,g=G(b),h=arguments.length==1?!g.is(B):c,i=h?"expand":"collapse",j=e.animation[i],k=d.dataItem(b),l;if(g.data("animating"))return;if(h==d._expanded(b))return;d._trigger(i,b)||(d._expanded(b,h),l=k&&k.loaded(),l&&g.children().length>0?(d._updateNodeClasses(b,{},{expanded:h}),h||g.css("height",g.height()).css("height"),g.kendoStop(!0,!0).kendoAnimate(f({reset:!0},j,{complete:function(){h&&g.css("height","")}}))):k&&(e.loadOnDemand&&d._progress(b,!0),g.remove(),k.load()))}},destroy:function(){var a=this;i.fn.destroy.call(a),a.element.off(l),a.dragging&&a.dragging.destroy(),c.destroy(a.element)},_expanded:function(a,b){var d=c.attr("expanded"),e=this.dataItem(a);if(arguments.length==1)return a.attr(d)==="true"||e&&e.expanded;e&&e.set("expanded",b),b?a.attr(d,"true"):a.removeAttr(d)},_progress:function(a,b){var c=this.element;arguments.length==1?(b=a,b?c.html(this.templates.loading):c.empty()):a.find(">div>.k-icon").toggleClass("k-loading",b)},text:function(b,c){b=a(b).closest(C).find(">div>.k-in");if(c)b.text(c);else return b.text()},_objectOrSelf:function(b){return a(b).closest("[data-role=treeview]").data("kendoTreeView")||this},_dataSourceMove:function(b,d,f,g){var i=this,j=i._objectOrSelf(b),k,l,m,n,o=i._objectOrSelf(f||d),p=o.dataSource;f&&(m=o.dataItem(f),m.loaded()||(o._progress(f,!0),m.load()),f!=i.root&&(p=m.children));if(b instanceof a||I(b))b=a(b),k=j.dataSource,l=k.getByUid(b.attr(c.attr("uid"))),l&&(l=k.remove(l)),l=g(p,l);else if(h(b)||b instanceof e.ObservableArray)for(n=0;n<b.length;n++)l=g(p,b[n]);else l=g(p,b);return l&&i.findByUid(l.uid)},insertAfter:function(a,b){var c=b.parent(),d;c.parent().is("li")&&(d=c.parent());return this._dataSourceMove(a,c,d,function(a,c){return a.insert(b.index()+1,c)})},insertBefore:function(a,b){var c=b.parent(),d;c.parent().is("li")&&(d=c.parent());return this._dataSourceMove(a,c,d,function(a,c){return a.insert(b.index(),c)})},append:function(a,b){var c=this,d=c.root;b&&(d=F(b));return c._dataSourceMove(a,d,b,function(a,d){b&&c._expanded(b,!0);if(a.data())return a.add(d);a.one(o,function(){a.add(d)});return null})},_remove:function(b,c){var d=this,e,f,g;b=a(b,d.element),e=b.parent().parent(),f=b.prev(),g=b.next(),b[c?"detach":"remove"](),e.hasClass("k-item")&&(L(e),d._updateNodeClasses(e)),d._updateNodeClasses(f),d._updateNodeClasses(g);return b},remove:function(a){var b=this.dataItem(a);b&&this.dataSource.remove(b)},detach:function(a){return this._remove(a,!0)},findByText:function(b){return a(this.element).find(".k-in").filter(function(c,d){return a(d).text()==b}).closest(C)},findByUid:function(a){return this.element.find(".k-item["+c.attr("uid")+"="+a+"]")},_renderItem:function(a){a.group||(a.group={}),a.treeview=this.options,a.r=D;return this.templates.item(a)},_renderGroup:function(a){var b=this;a.renderItems=function(a){var c="",d=0,e=a.items,f=e?e.length:0,g=a.group;g.length=f;for(;d<f;d++)a.group=g,a.item=e[d],a.item.index=d,c+=b._renderItem(a);return c},a.r=D;return b.templates.group(a)}}),M.prototype={_removeTouchHover:function(){var a=this;c.support.touch&&a.hovered&&(a.hovered.find("."+z).removeClass(z),a.hovered=!1)},_hintStatus:function(b){var c=this._draggable.hint.find(".k-drag-status")[0];if(b)c.className="k-icon k-drag-status "+b;else return a.trim(c.className.replace(/k-(icon|drag-status)/g,""))},dragstart:function(b){var c=this,d=c.treeview,e=c.sourceNode=b.currentTarget.closest(C);d.trigger(r,{sourceNode:e[0]})&&b.preventDefault(),c.dropHint=a("<div class='k-drop-hint' />").css(x,"hidden").appendTo(d.element)},drag:function(b){var d=this,e=d.treeview,f=d.sourceNode,g=d.dropTarget=a(c.eventTarget(b)),h,i=g.closest(".k-treeview"),j,k,l,m,n,o,p,q,r;i.length?a.contains(f[0],g[0])?h="k-denied":(h="k-insert-middle",j=g.closest(".k-top,.k-mid,.k-bot"),j.length?(l=j.outerHeight(),m=j.offset().top,n=g.closest(".k-in"),o=l/(n.length>0?4:2),p=b.y.location<m+o,q=m+l-o<b.y.location,d._removeTouchHover(),r=n.length&&!p&&!q,d.hovered=r?i:!1,d.dropHint.css(x,r?"hidden":"visible"),n.toggleClass(z,r),r?h="k-add":(k=j.position(),k.top+=p?0:l,d.dropHint.css(k)[p?"prependTo":"appendTo"](g.closest(C).children("div:first")),p&&j.hasClass("k-top")&&(h="k-insert-top"),q&&j.hasClass("k-bot")&&(h="k-insert-bottom"))):g[0]!=d.dropHint[0]&&(h="k-denied")):(h="k-denied",d._removeTouchHover()),e.trigger(s,{sourceNode:f[0],dropTarget:g[0],pageY:b.y.location,pageX:b.x.location,statusClass:h.substring(2),setStatusClass:function(a){h=a}}),h.indexOf("k-insert")!==0&&d.dropHint.css(x,"hidden"),d._hintStatus(h)},dragcancel:function(a){this.dropHint.remove()},dragend:function(a){var b=this,c=b.treeview,d="over",e=b.sourceNode,f,g=b.dropHint,h,i;g.css(x)=="visible"?(d=g.prevAll(".k-in").length>0?"after":"before",f=g.closest(C)):b.dropTarget&&(f=b.dropTarget.closest(C)),h=b._hintStatus()!="k-denied",i=c.trigger(t,{sourceNode:e[0],destinationNode:f[0],valid:h,setValid:function(a){h=a},dropTarget:a.target,dropPosition:d}),g.remove(),b._removeTouchHover();!h||i?b._draggable.dropped=h:(b._draggable.dropped=!0,d=="over"?e=c.append(e,f):d=="before"?e=c.insertBefore(e,f):d=="after"&&(e=c.insertAfter(e,f)),c.trigger(u,{sourceNode:e&&e[0],destinationNode:f[0],dropPosition:d}))},destroy:function(){this._draggable.destroy()}},D={wrapperCssClass:function(a,b){var c="k-item",d=b.index;a.firstLevel&&d===0&&(c+=" k-first"),d==a.length-1&&(c+=" k-last");return c},cssClass:function(a,b){var c="",d=b.index,e=a.length-1;a.firstLevel&&d===0&&(c+="k-top "),d===0&&d!=e?c+="k-top":d==e?c+="k-bot":c+="k-mid";return c},textClass:function(a){var b="k-in";a.enabled===!1&&(b+=" k-state-disabled"),a.selected===!0&&(b+=" k-state-selected");return b},toggleButtonClass:function(a){var b="k-icon";a.expanded!==!0?b+=" k-plus":b+=" k-minus",a.enabled===!1&&(b+="-disabled");return b},groupAttributes:function(a){return a.expanded!==!0?" style='display:none'":""},groupCssClass:function(a){var b="k-group";a.firstLevel&&(b+=" k-treeview-lines");return b}},d.plugin(E)})(jQuery);